## Learning High-Speed Flight in the Wild  

### 0. 논문 정보 (Reference)  
* **Title:** Learning High-Speed Flight in the Wild  
* **Authors:** Antonio Loquercio, Elia Kaufmann, René Ranftl, Matthias Müller, Vladlen Koltun, Davide Scaramuzza  
* **Journal:** Science Robotics Vol. 6, Issue 59, 2021  
* **DOI:** 10.1126/scirobotics.abg5810  
* **arXiv:** 2110.05113  
* **Open Source:** https://github.com/uzh-rpg/agile_autonomy  
  

---  
  

### 1. Introduction  
  

배경. 쿼드로터는 가장 민첩하고 동적인 기계 중 하나다.  
숲이나 도시 협곡과 같이 복잡한 환경을 고속으로 통과할 수 있지만, 이러한 기민함을 완전히 활용한 것은 오직 인간의 숙련된 조종사뿐이었다.  
대부분의 연구는 감지→맵핑→경로계획→제어라는 단계적 파이프라인에 의존한다.  
이 방식은 모듈화 덕분에 해석 가능성과 병렬 개발의 장점이 있지만, 각 단계의 지연(latency)이 누적되고 오차가 전파되며, 모듈 간 상호작용이 모델링되지 않아 고속 비행 시 본질적인 한계를 초래한다.  
  

문제 제기. 고속 비행에서 센서 지연, 모듈 간 통신 지연, 노이즈 누적이 심각한 성능 저하를 초래한다.  
맵핑 기반 접근은 여러 관측을 통합해야 하므로 지연이 증가하고, 고속 이동 시 관측 중첩(overlap)이 줄어 맵 정확도가 낮아진다.  
반면, 기존 엔드투엔드 학습은 데이터 요구량이 커서 2D 평면이나 제한된 동작만 학습하는 등 표현력을 희생했다.  
  

핵심 아이디어. 논문은 센서 관측을 즉시 수평선(receding horizon) 충돌 회피 궤적으로 변환하는 엔드투엔드 정책을 제시한다.  
컨볼루션 신경망을 이용해 노이즈가 있는 depth 영상을 입력으로 받아 바로 충돌 없는 궤적 집합을 출력하여 파이프라인을 통합한다.  
전체적인 지연을 크게 줄이고 노이즈에 더 견고하며, 시뮬레이션에서 특권 정보를 가진 전문가를 모방(Privileged Learning)하여 학습함으로써 현실 환경에서 제로샷 전이가 가능하다.  
  

기여. 이 접근 방식은 10 m/s 수준의 고속 자율 비행을 자연·도시 환경에서 실현하며, 기존 방법 대비 실패율을 최대 10배까지 줄인다.  
또한 시뮬레이션과 실제 시험을 통해 분석한 결과 및 공학적 설계 요인을 제시한다.  
  

---  
  

### 2. Results  
  

본 논문의 실험 결과는 실환경 고속 비행, 제어된 시뮬레이션, 계산 복잡도 비교, 센서 지연 및 노이즈 영향의 네 가지 하위 섹션으로 구성된다.  
  

#### A. High-Speed Flight in the Wild  
  

연구진은 자연 환경(숲, 산악, 눈)과 인간 환경(무너진 건물, 비행기 격납고, 도시 거리 등)에서 총 56회의 실험을 수행하였다.  
각 실험에서 길이 40 m의 직선 또는 반지름 6 m의 원형 참조 궤적이 주어졌으며, 이는 직접 실행하면 충돌을 일으키는 경로였다.  
드론은 참조 궤적을 따라가면서 장애물을 감지할 경우 즉석에서 회피해야 했다.  
  

성능 지표. 성공률은 목표 지점을 반경 5 m 이내로 충돌 없이 도달한 비율로 정의한다.  
3 m/s와 5 m/s에서는 100% 성공률을 달성했고, 7 m/s에서는 80%, 10 m/s에서는 60%의 성공률을 기록했다.  
이는 기존 방법이 최대 2.29 m/s에서 성능 한계가 발생하는 것과 대조적이다.  
  

자연 환경. 숲과 산악 지형에서는 얇은 나무, 울창한 수목, 눈에 덮인 지면 등 다양한 장애물이 존재해, 저지연 제어와 견고한 감지가 요구됐다.  
평균 속도 7 m/s에서도 10회 중 8회 성공했으며, 10 m/s에서 60%의 성공률을 유지했다.  
실패는 주로 시야에 늦게 나타난 장애물이나 폭이 1 m 미만의 좁은 공간에서 발생했다.  
  

인간 환경. 도심과 폐허에서는 크기와 형태가 다양한 장애물(기차, 크레인, 건물, 철근 등)이 있고, 긴 사전 회피 동작이 필요한 경우가 많았다.  
3~7 m/s 범위에서 19개의 실험을 수행한 결과, 제안 방법이 100% 성공했으며 10 m/s 이상은 위험을 고려해 수행하지 않았다.  
또한 상용 드론(Skydio R1)과의 비교 실험에서, 0.8 m 폭의 좁은 개구를 통과하는 과제를 수행한 결과 상용 드론은 모두 실패한 반면 제안 방법은 매 번 성공했다.  
  

---  
  

#### B. Controlled Experiments  
  

시뮬레이션에서는 네 가지 환경(숲, 좁은 틈, 재난, 도시)을 설정하고, FastPlanner(맵핑+계획 기반), Reactive(모션 프리미티브 기반), Blind(참조만 따름)과 비교했다.  
Flightmare 시뮬레이터와 RotorS Gazebo 플러그인을 사용하여 정확한 물리 모델을 구현했다.  
  

속도별 성능. 3 m/s에서 모든 방법이 유사한 성능을 보였으나, 5 m/s 이상에서는 두 baseline의 성공률이 급격히 감소한다.  
10 m/s에서는 baseline이 전혀 성공하지 못하는 반면, 제안 방법은 평균 70% 성공률을 기록했다.  
  

원인 분석. Reactive는 지연은 적지만 프리미티브 라이브러리가 제한적이라 복잡한 장애물 구성을 모두 대응하지 못한다.  
FastPlanner는 여러 관측을 통합하여 노이즈에 강하지만, 이로 인해 처리 지연이 커지고 고속 이동 시 관측 중첩이 줄어드는 문제가 있다.  
제안 방법은 낮은 지연과 데이터 기반 학습으로 센서 노이즈에 강해 이러한 문제를 해소한다.  
  

환경별 결과.  
a. 숲: Poisson 점 과정으로 빽빽한 숲을 생성하고 속도를 3~10 m/s로 조절한 실험에서, 우리 방법은 5 m/s까지 100% 성공, 10 m/s에서 60% 성공을 달성했다.  
b. 좁은 틈: 40 m 길이의 벽에 폭 0.8~1.0 m의 틈을 무작위 위치에 배치한 실험에서 baseline은 5 m/s 이상에서 거의 실패한 반면 우리 방법은 7 m/s에서도 80% 성공률을 유지했다.  
c. 재난/도시: 복잡한 지형의 재난·도시 환경에서는 baseline이 낮은 속도에서도 오류가 많았으나, 우리 방법은 7 m/s에서 100% 성공, 10 m/s에서 80% 이상 성공률을 기록했다.  
  

---  
  

#### C. Computational Cost  
  

세 방법의 구성별 처리 지연을 측정한 결과(Table 1)는 다음과 같다.  
  

| Method | Pre-processing (ms) | Mapping/NN (ms) | Projection (ms) | Total Latency (ms) | 비고 |  
|---|---:|---:|---:|---:|---|  
| FastPlanner | 14.6 ± 2.3 | 49.2 ± 8.7 (mapping) | 1.4 ± 1.6 | 65.2 | 여러 관측을 통합해야 함. |  
| Reactive | 13.8 ± 1.3 | 5.3 ± 0.9 (primitive planning) | – | 19.1 | 지연은 적지만 표현력이 제한적. |  
| Ours (desktop CPU) | 0.1 ± 0.04 | 10.1 ± 1.5 (NN inference) | 0.08 ± 0.01 | 10.3 | GPU 사용 시 2.6 ms로 단축. |  
| Ours (Jetson TX2) | 0.2 ± 0.1 | 38.9 ± 4.5 | 2.5 ± 1.5 | 41.6 | 온보드 PC 성능 기준. |  
  

우리 방법은 GPU에서 실행 시 FastPlanner보다 25배, Reactive보다 7배 이상 빠르며, 심지어 CPU만으로도 baseline보다 지연이 낮다.  
이는 맵핑 단계를 생략하여 지연을 최소화한 구조 덕분이다.  
  

---  
  

#### D. The effect of latency and sensor noise  
  

센서 지연과 노이즈가 비행 성능에 미치는 영향을 이해하기 위해, 단일 장애물을 회피하는 실험을 수행하였다.  
쿼드로터를 직진시키면서 거리 6 m의 원형 기둥을 피해야 하는 과제를 설정하고, 전방 속도를 3~13 m/s로 변경하며, 깊이 정보의 정확도와 지연을 달리했다.  
  

이론적 최대 속도. Falanga et al.의 분석을 확장하여, 감지 범위와 센서 지연, 회전 운동 지연을 고려한 최대 속도를 계산하였다.  
각 방법의 처리 지연이 다르므로 이론적 상한선도 달라진다.  
  

실험 결과. 완벽한(depth ground truth) 경우 모든 방법이 5 m/s까지 무사히 회피했지만 baseline은 6 m/s 이상에서 성능이 급격히 저하되었다.  
우리 방법은 7 m/s까지 100% 성공, 10 m/s에서 60% 성공률을 기록했다.  
깊이 추정 노이즈가 있는 경우 baseline의 성능은 5 m/s 이상에서 거의 0%로 떨어지지만, 우리 방법은 10 m/s에서 단 10%의 성능 감소만 나타났다.  
이는 SGM 기반 depth 입력이 시뮬레이션과 현실에서 유사하며, 네트워크가 노이즈 패턴을 학습했기 때문이다.  
  

---  
  

### 3. Discussion  
  

기존 자율 비행 시스템은 모듈화를 통해 구현을 단순화하였지만, 모듈간 지연과 오차 누적, 상호작용 부재가 고속 비행에 근본적인 제약을 준다.  
본 연구는 감지·맵핑·경로계획을 통합한 단일 신경망 함수로 대체하였다.  
이 신경망은 depth 이미지, 속도, 자세, 목표 방향을 입력으로 받아 충돌 위험이 낮은 세 가지 궤적을 예측하고, 비용 최소 궤적을 MPC로 추종한다.  
이 방법은 모듈 간 통신 없이 한 번의 추론으로 경로를 산출하므로 지연이 크게 줄고, 데이터 기반으로 센서 노이즈에 대한 견고성을 갖는다.  
  

성공 요인. 1) 특권 전문가를 통한 모방학습으로 복잡한 다봉 분포를 효율적으로 학습하고, 2) 다중 모드 출력을 통해 여러 회피 전략을 동시에 고려하며, 3) 깊이 기반 추상 입력으로 시뮬레이션-현실 차이를 최소화했다.  
이러한 설계 조합이 고속 비행에서 기존 방법 대비 10배 이상 낮은 실패율을 달성하게 했다.  
  

한계 및 향후 연구. 10 m/s 이상의 극한 속도에서는 전문가조차 충돌 없는 궤적을 찾기 어렵고, 시뮬레이션과 현실 간 동역학 차이, 배터리 전압 저하, 공력 등의 영향으로 성능이 떨어진다.  
보다 정교한 전문가나 모델 프리 방식의 도입, 센서 지연을 줄이기 위한 이벤트 카메라 적용 등이 제안된다.  
또한 단거리 회피 정책과 장거리 계획자의 통합이 향후 중요한 연구 주제다.  
  

---  
  

### 4. Materials and Methods  
  

이 절에서는 학습 데이터 수집, 특권 전문가, 학생 정책, 학습 환경, 검증 방법을 자세히 설명한다.  
  

#### A. Privileged Expert  
  

특권 전문가는 실제 환경에서 얻기 어려운 완전한 3D 맵과 정확한 상태를 사용하여 최적 궤적을 생성한다.  
목표는 참조 궤적 τ_ref와 환경 포인트클라우드 C가 주어졌을 때, 1초 동안 충돌 없는 궤적 τ를 샘플링하는 것이다.  
이를 위해 다음과 같은 확률 분포를 정의한다.  
  

$$
P(\tau \mid \tau_{\mathrm{ref}}, C)
=
\frac{1}{Z}\exp\bigl(-c(\tau,\tau_{\mathrm{ref}},C)\bigr)
$$  
  

$$
c(\tau,\tau_{\mathrm{ref}},C)
=
\int_{0}^{1}\lambda_c\,C_{\mathrm{collision}}(\tau(t))\,dt
+
\int_{0}^{1}\bigl[\tau(t)-\tau_{\mathrm{ref}}(t)\bigr]^{\top}
Q
\bigl[\tau(t)-\tau_{\mathrm{ref}}(t)\bigr]\,dt
$$  
  

여기서 λ_c=1000은 충돌 비용 가중치, Q는 상태 오차 가중 행렬이다.  
C_collision은 쿼드로터를 반경 0.2 m의 구로 모델링하여 장애물까지의 거리에 따른 비용을 정의한다.  
거리가 2·r_q보다 크면 0이고, 그 이하에서는 −d_c^2/r_q^2 + 4로 증가한다.  
  

분포 P는 환경에 따라 다봉(multi-modal) 구조를 가지므로, 전문가 알고리즘은 Metropolis–Hastings 샘플링을 통해 약 5만 개의 궤적을 샘플링한다.  
궤적은 3개의 제어점을 갖는 cubic B-spline으로 표현하고, 제어점을 구면 좌표계에서 샘플링하여 동역학적 연속성(위치, 속도, 가속도)을 유지한다.  
또한 글로벌 최적 경로 τ_gbl을 미리 계산하여 샘플링을 해당 궤적 주변으로 유도함으로써 탐색 공간을 줄이고 보수적인 궤적을 생성한다.  
충돌한 궤적은 제거하고, 비용이 낮은 상위 3개 궤적만 학생 정책의 학습 레이블로 사용한다.  
  

---  
  

#### B. The Student Policy  
  

학생 정책은 온보드 센서만을 사용하여 실시간으로 궤적을 생성한다.  
입력은 depth 이미지 d ∈ ℝ^{640×480}, 플랫폼 속도 v ∈ ℝ³, 자세 q ∈ ℝ⁹, 참조 방향 ω ∈ ℝ³이며, 출력은 M=3개의 궤적 후보와 각 후보의 충돌 비용이다.  
  

네트워크는 두 브랜치로 구성된다.  
  

Visual branch: MobileNet-V3 백본과 1D convolution을 통해 깊이 영상에서 모드당 32차원의 특징을 추출한다.  
State branch: 속도, 자세, 참조 방향을 네 층의 MLP([64, 32, 32, 32])로 처리하여 32차원 특징을 얻는다.  
이후 두 특징을 모드별로 결합하여 4층 MLP([64, 128, 128])를 통해 궤적과 비용을 출력한다.  
예측된 궤적 τ_kn은 0.1 s 간격으로 10개의 위치 샘플을 포함하며, 제어점 대신 직접 위치를 출력하여 테스트 시 보간 비용을 줄였다.  
  

학습. 각 샘플에 대해 전문가가 제공한 3개의 궤적 Te와 네트워크가 예측한 3개의 궤적 Tn의 대응관계를 Relaxed Winner-Takes-All(R-WTA) 손실로 최적화한다.  
이 손실은 가장 가까운 네트워크 궤적에는 가중치 0.95, 나머지에는 0.025를 부여하여 모드 붕괴를 방지한다.  
또한 각 궤적의 충돌 비용 예측 c_k는 실제 충돌 비용 C_collision(τ_kn)과 L2 손실로 학습한다.  
최종 손실은 두 항을 λ₁=10, λ₂=0.1의 비율로 가중합하여 Adam optimizer로 학습한다.  
  

추종 제어. 네트워크가 출력하는 위치 샘플은 5차 다항식으로 투영하여 위치, 속도, 가속도의 연속성을 만족하도록 변환한다.  
각 축에 대해 계수 a_x를 최소 제곱으로 찾고 현재 상태와의 연속 조건을 부과한다(식 8).  
투영된 궤적 중에서 비용이 최소 값의 95% 이내인 후보들 중 입력 비용이 가장 작은 것을 선택해 MPC로 추종한다.  
이는 연속성을 유지하여 불필요한 방향 전환을 피한다.  
  

---  
  

#### C. Training Environments  
  

Flightmare와 Unity 엔진을 이용해 총 850개의 훈련 환경을 생성했다.  
훈련 환경은 두 범주로 나뉜다.  
  

나무가 있는 숲: 다양한 높이·두께의 나무를 Poisson 점 과정에 따라 배치했다.  
볼록 형태들: 타원체, 상자, 실린더 등 볼록 도형을 랜덤 크기(0.5~4 m, 높이 0.5~8 m)로 배치했다.  
모든 환경에서 intensity δ를 4~7 사이에서 랜덤으로 샘플링하여 장애물 밀도를 다양화했다.  
각 환경마다 시작 지점에서 40 m 앞까지의 글로벌 경로 τ_gbl을 계산하고, 학생 정책은 직선 참조 궤적만 받아 목표를 인식한다.  
  

데이터셋 축적. DAgger를 활용하여 학생 정책이 실패하는 상태를 전문가가 라벨링하도록 하였고, 90K개의 샘플을 수집했다.  
좁은 틈 실험을 위해서는 폭 0.7~1.2 m의 틈을 가진 50 m 길이의 벽을 추가하여 10K개의 추가 데이터를 수집해 미세 조정했다.  
  

---  
  

#### D. Method Validation  
  

설계 선택의 중요성을 검증하기 위해 세 가지 요소를 제거한 ablation study를 수행했다.  
  

Global planning 초기화(LocalPlan): 전문가 샘플링에서 글로벌 경로 초기화를 제거하면 고속에서 성능이 급격히 떨어진다.  
다중 모드 학습(UniModal): 모드 하나만 예측하는 모델은 환경의 다모드성을 처리하지 못해 성능이 크게 감소한다.  
RGB 입력(RGB): 깊이 대신 컬러 이미지로 학습하면 도메인 갭이 커져 성능이 하락한다.  
단일 포인트 예측(SinglePoint): 1 s 전체 궤적 예측 대비 표현력이 부족해 고속에서 성능이 크게 떨어졌다.  
  

---  
  

### 5. Acknowledgments & Supplementary Materials  
  

논문에서는 드론 설계, 시뮬레이션 환경 구축, 멀티미디어 제작에 기여한 공동 연구자들에게 감사를 표하며, Intel Network on Intelligent Systems, SNSF NCCR Robotics, ERC AGILEFLIGHT 등으로부터의 연구 지원을 명시한다.  
원문 마지막에는 추가 참고자료로 6개의 보조 섹션과 여러 그림/영상 자료를 안내한다.  
  

S1. 추정 및 제어 노이즈에 대한 민감도 분석  
S2. 장애물 밀도 변화가 성능에 미치는 영향  
S3. 실험 플랫폼 하드웨어 세부 사항  
S4. 계산 복잡도 세부 분석  
S5. 단일 폴 회피 시 이론적 최대 속도 산출  
S6. Metropolis–Hastings 샘플링 기법  
Figure S1–S6, Movie S1–S2 포함.  
  

---  
  

### 6. 결론 및 공학적 평가  
  

본 연구는 고속 자율 비행을 위해 기존의 모듈화된 파이프라인을 깨고, 특권 모방 학습 + 다중 모드 예측 + MPC라는 하이브리드 구조를 제시하였다.  
중요한 점은 모델 전부가 완전한 end-to-end가 아니라, 신경망이 단기 궤적 후보를 제안하고 MPC가 동역학적으로 추종함으로써 안정성과 제약 만족을 보장한다는 것이다.  
  

왜 설계가 합리적인가?  
1) 맵을 유지하지 않으므로 지연이 현저히 줄고 고속 환경에서 치명적인 센서 지연 문제를 완화한다.  
2) 다중 모드 예측과 R-WTA 손실은 회피 경로의 다봉성을 포착해 mode collapse를 방지한다.  
3) depth 입력 사용은 시뮬레이션과 현실 사이의 도메인 갭을 줄여 제로샷 전이를 가능하게 한다.  
4) 학생 정책은 경량 구조로 온보드 임베디드 시스템에서도 실시간으로 실행 가능하며, GPU 이용 시 지연이 수 밀리초 수준이다.  
  

영향 및 활용. 이 연구는 탐사, 구조, 배달, 영화 촬영과 같은 응용 분야에서 고속 자율 드론의 실용화를 앞당길 것으로 기대된다.  
또한 단기 회피 정책과 장기 경로 계획의 결합, 이벤트 카메라 등 새로운 센서와의 통합, 모델 프리 강화학습 도입 등 다양한 후속 연구 기회를 제시한다.  
  

마지막으로, 본 리뷰는 원본 논문의 주요 내용을 최대한 충실히 번역·요약하면서, 각 설계 선택의 공학적 의미와 실험 결과의 맥락을 강조하였다.  
이는 향후 연구자나 엔지니어가 논문을 이해하고 자신의 시스템에 응용하는 데 도움이 되길 바란다.  

---

**Review by 변정우, Aerospace Engineering Undergraduate Researcher**  
**[Update - Time Log]**  
* 2026.02.28: [Draft] 전체적인 내용 리딩 완료 및 초안 작성  
* 2026.03.: [ver_1] part 1, 2 수식 및 관련 내용 업데이트  
* 2026.03.: [Final ver] 나머지 내용 내용 업데이트 및 전체적으로 검토
